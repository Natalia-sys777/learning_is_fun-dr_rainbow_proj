from django.core.management.base import BaseCommand
from lessons.models import Lesson, Exercise
from django.utils.text import slugify

class Command(BaseCommand):
    help = "–ó–∞–≤–∞–Ω—Ç–∞–∂—É—î —Å—Ç–∞—Ä—Ç–æ–≤—ñ —É—Ä–æ–∫–∏ –∑ –≤–ø—Ä–∞–≤–∞–º–∏ —É –±–∞–∑—É –¥–∞–Ω–∏—Ö"

    def handle(self, *args, **options):
        lessons_data = [
            {
                "title": "üîç –©–æ —Ç–∞–∫–µ —Ñ—ñ–∑–∏–∫–∞?",
                "emoji": "üîç",
                "summary": "–î—ñ–∑–Ω–∞—î–º–æ—Å—å, —â–æ —Ç–∞–∫–µ —Ñ—ñ–∑–∏–∫–∞ —ñ —á–æ–º—É –≤–æ–Ω–∞ –≤—Å—é–¥–∏ –Ω–∞–≤–∫–æ–ª–æ –Ω–∞—Å!",
                "level": "–¥—É–∂–µ –ª–µ–≥–∫–æ",
                "duration": 10,
                "age_range": "6‚Äì9",
                "materials": "–∫–Ω–∏–≥–∞, –º‚Äô—è—á–∏–∫, –ª–æ–∂–∫–∞, –º–∞–≥–Ω—ñ—Ç (–Ω–µ –æ–±–æ–≤‚Äô—è–∑–∫–æ–≤–æ)",
                "steps": "–ü–æ–¥–∏–≤–∏—Å—å –Ω–∞ —Ä—ñ–∑–Ω—ñ –ø—Ä–µ–¥–º–µ—Ç–∏ –Ω–∞–≤–∫–æ–ª–æ; –ü–æ–¥—É–º–∞–π, —è–∫ –≤–æ–Ω–∏ —Ä—É—Ö–∞—é—Ç—å—Å—è –∞–±–æ –ø—Ä–∞—Ü—é—é—Ç—å; –û–±–≥–æ–≤–æ—Ä–∏ —Ä–∞–∑–æ–º, —è–∫ —Ü–µ –ø–æ–≤‚Äô—è–∑–∞–Ω–æ –∑ —Ñ—ñ–∑–∏–∫–æ—é",
                "assistant_image": "images/assistant_boy.png",
                "theory": """
üîç –§—ñ–∑–∏–∫–∞ ‚Äî —Ü–µ –Ω–∞—É–∫–∞, —è–∫–∞ –¥–æ–ø–æ–º–∞–≥–∞—î –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, —á–æ–º—É –ø—Ä–µ–¥–º–µ—Ç–∏ –ø–∞–¥–∞—é—Ç—å, —è–∫ —â–æ—Å—å —Ä—É—Ö–∞—î—Ç—å—Å—è, –∑–≤—ñ–¥–∫–∏ –±–µ—Ä–µ—Ç—å—Å—è —Å–≤—ñ—Ç–ª–æ —ñ —è–∫ —á—É—Ç–∏ –∑–≤—É–∫.
–¶–µ —è–∫ —á–∞—Ä—ñ–≤–Ω—ñ –æ–∫—É–ª—è—Ä–∏: –Ω–∞–¥—è–≥–∞—î—à ‚Äî —ñ –±–∞—á–∏—à, —è–∫ –ø—Ä–∞—Ü—é—î —Å–≤—ñ—Ç –Ω–∞–≤–∫–æ–ª–æ —Ç–µ–±–µ!
""",
                "safety_note": "",
                "exercises": [
                    {
                        "title": "–ó–Ω–∞–π–¥–∏ —Ñ—ñ–∑–∏–∫—É –Ω–∞–≤–∫–æ–ª–æ",
                        "instructions": "–ü–æ–¥–∏–≤–∏—Å—å –Ω–∞–≤–∫–æ–ª–æ ‚Äî —â–æ –∑ —Ç–æ–≥–æ, —â–æ —Ç–∏ –±–∞—á–∏—à, –º–æ–∂–Ω–∞ –ø–æ—è—Å–Ω–∏—Ç–∏ —Ñ—ñ–∑–∏–∫–æ—é? –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —á–æ–º—É –º‚Äô—è—á –∫–æ—Ç–∏—Ç—å—Å—è?",
                        "difficulty": "easy",
                        "duration": 5
                    },
                    {
                        "title": "–°–ø—Ä–æ–±—É–π –ø–æ—è—Å–Ω–∏—Ç–∏",
                        "instructions": "–í—ñ–∑—å–º–∏ –±—É–¥—å-—è–∫–∏–π –ø—Ä–µ–¥–º–µ—Ç —ñ —Å–ø—Ä–æ–±—É–π —Å–∫–∞–∑–∞—Ç–∏, —á–æ–º—É –≤—ñ–Ω –ø—Ä–∞—Ü—é—î —Å–∞–º–µ —Ç–∞–∫. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —á–æ–º—É –ª–æ–∂–∫–∞ –ø–∞–¥–∞—î, –∫–æ–ª–∏ —ó—ó –≤—ñ–¥–ø—É—Å—Ç–∏—Ç–∏?",
                        "difficulty": "medium",
                        "duration": 7
                    }
                ]
            },
            {
                "title": "‚öñÔ∏è –©–æ —Ç–∞–∫–µ –º–∞—Å–∞?",
                "emoji": "‚öñÔ∏è",
                "summary": "–í—á–∏–º–æ—Å—è —Ä–æ–∑—Ä—ñ–∑–Ω—è—Ç–∏ –º–∞—Å—É –ø—Ä–µ–¥–º–µ—Ç—ñ–≤ ‚Äî —â–æ –≤–∞–∂–∫–µ, –∞ —â–æ –ª–µ–≥–∫–µ?",
                "level": "–ª–µ–≥–∫–æ",
                "duration": 15,
                "age_range": "6‚Äì9",
                "materials": "–≤–∞–≥–∏, —è–±–ª—É–∫–æ, –∫–∞–º—ñ–Ω—á–∏–∫, –ø–æ–¥—É—à–∫–∞",
                "steps": "–ü–æ—Ä—ñ–≤–Ω—è–π –¥–≤–∞ –ø—Ä–µ–¥–º–µ—Ç–∏; –ü–æ–∫–ª–∞–¥–∏ —ó—Ö –Ω–∞ –≤–∞–≥–∏; –ü–æ–¥–∏–≤–∏—Å—å, —è–∫–∏–π –≤–∞–∂—á–∏–π",
                "assistant_image": "images/assistant_girl.png",
                "theory": """
‚öñÔ∏è –ú–∞—Å–∞ ‚Äî —Ü–µ —Ç–µ, —Å–∫—ñ–ª—å–∫–∏ –≤–∞–∂–∏—Ç—å –ø—Ä–µ–¥–º–µ—Ç. –î–µ—è–∫—ñ —Ä–µ—á—ñ –ª–µ–≥–∫—ñ (—è–∫ –ø–æ–¥—É—à–∫–∞), –∞ –¥–µ—è–∫—ñ ‚Äî –≤–∞–∂–∫—ñ (—è–∫ –∫–∞–º—ñ–Ω—å).
–ú–∏ –º–æ–∂–µ–º–æ –≤–∏–º—ñ—Ä—è—Ç–∏ –º–∞—Å—É –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –≤–∞–≥.
""",
                "safety_note": "–ë—É–¥—å—Ç–µ –æ–±–µ—Ä–µ–∂–Ω—ñ –∑ –≤–∞–∂–∫–∏–º–∏ –ø—Ä–µ–¥–º–µ—Ç–∞–º–∏ ‚Äî –Ω–µ –∫–∏–¥–∞–π—Ç–µ —ó—Ö —ñ –Ω–µ –∫–ª–∞–¥—ñ—Ç—å –Ω–∞ –∫—Ä–∞–π —Å—Ç–æ–ª–∞.",
                "exercises": [
                    {
                        "title": "–©–æ –≤–∞–∂—á–µ?",
                        "instructions": "–í—ñ–∑—å–º–∏ –¥–≤–∞ –ø—Ä–µ–¥–º–µ—Ç–∏ —Ç–∞ –ø–æ—Ä—ñ–≤–Ω—è–π, —è–∫–∏–π –≤–∞–∂—á–∏–π. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —è–±–ª—É–∫–æ —ñ –∫–Ω–∏–∂–∫–∞.",
                        "difficulty": "easy",
                        "duration": 5
                    },
                    {
                        "title": "–í–≥–∞–¥–∞–π –º–∞—Å—É",
                        "instructions": "–ó–∞–ø—Ä–æ–ø–æ–Ω—É–π –¥—ñ—Ç—è–º –≤–≥–∞–¥–∞—Ç–∏, —Å–∫—ñ–ª—å–∫–∏ –≤–∞–∂–∏—Ç—å –ø—Ä–µ–¥–º–µ—Ç, –∞ –ø–æ—Ç—ñ–º –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –Ω–∞ –≤–∞–≥–∞—Ö.",
                        "difficulty": "medium",
                        "duration": 7
                    }
                ]
            },
            {
                "title": "üß™ –©–æ —Ç–∞–∫–µ –æ–±'—î–º?",
                "emoji": "üß™",
                "summary": "–ù–∞–≤—á–∏–º–æ—Å—è —Ä–æ–∑—É–º—ñ—Ç–∏, —Å–∫—ñ–ª—å–∫–∏ –º—ñ—Å—Ü—è –∑–∞–π–º–∞—î –≤–æ–¥–∞ —á–∏ —ñ–Ω—à—ñ —Ä–µ—á–æ–≤–∏–Ω–∏.",
                "level": "–ª–µ–≥–∫–æ",
                "duration": 15,
                "age_range": "6‚Äì9",
                "materials": "—Å–∫–ª—è–Ω–∫–∞, –ø–ª—è—à–∫–∞, –º—ñ—Ä–Ω–∏–π —Å—Ç–∞–∫–∞–Ω, –≤–æ–¥–∞",
                "steps": "–ù–∞–ª–∏–π –≤–æ–¥—É –≤ —Ä—ñ–∑–Ω—ñ —î–º–Ω–æ—Å—Ç—ñ; –ü–æ–¥–∏–≤–∏—Å—å, –¥–µ —ó—ó –±—ñ–ª—å—à–µ; –ü–æ—Ä—ñ–≤–Ω—è–π –æ–±‚Äô—î–º",
                "assistant_image": "images/assistant_girl.png",
                "theory": """
üß™ –û–±'—î–º ‚Äî —Ü–µ —Å–∫—ñ–ª—å–∫–∏ –º—ñ—Å—Ü—è —â–æ—Å—å –∑–∞–π–º–∞—î. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –≤–æ–¥–∞ –≤ –ø–ª—è—à—Ü—ñ –∑–∞–π–º–∞—î –±—ñ–ª—å—à–µ –º—ñ—Å—Ü—è, –Ω—ñ–∂ —É —Å–∫–ª—è–Ω—Ü—ñ.
–û–±'—î–º –º–æ–∂–Ω–∞ –≤–∏–º—ñ—Ä—é–≤–∞—Ç–∏ –≤ –º—ñ–ª—ñ–ª—ñ—Ç—Ä–∞—Ö –∞–±–æ –ª—ñ—Ç—Ä–∞—Ö.
""",
                "safety_note": "–ü—Ä–∞—Ü—é–π—Ç–µ –∑ –≤–æ–¥–æ—é –æ–±–µ—Ä–µ–∂–Ω–æ, —â–æ–± –Ω—ñ—á–æ–≥–æ –Ω–µ —Ä–æ–∑–ª–∏—Ç–∏ –Ω–∞ –µ–ª–µ–∫—Ç—Ä–æ–ø—Ä–∏–ª–∞–¥–∏.",
                "exercises": [
                    {
                        "title": "–ü–æ—Ä—ñ–≤–Ω—è–π –æ–±‚Äô—î–º",
                        "instructions": "–ù–∞–ª–∏–π –≤–æ–¥—É –≤ –¥–≤—ñ —Ä—ñ–∑–Ω—ñ –ø–æ—Å—É–¥–∏–Ω–∏. –ü–æ–¥–∏–≤–∏—Å—å, –¥–µ –±—ñ–ª—å—à–µ. –û–±–≥–æ–≤–æ—Ä–∏ —á–æ–º—É.",
                        "difficulty": "easy",
                        "duration": 5
                    },
                    {
                        "title": "–ú—ñ—Ä—è—î–º–æ –æ–±‚Äô—î–º",
                        "instructions": "–í–∏–∫–æ—Ä–∏—Å—Ç–∞–π –º—ñ—Ä–Ω–∏–π —Å—Ç–∞–∫–∞–Ω, —â–æ–± –≤–∏–º—ñ—Ä—è—Ç–∏, —Å–∫—ñ–ª—å–∫–∏ –º–ª –≤–ª—ñ–∑–ª–æ —É —Å–∫–ª—è–Ω–∫—É —á–∏ —á–∞—à–∫—É.",
                        "difficulty": "medium",
                        "duration": 7
                    }
                ]
            }
        ]

        for data in lessons_data:
            clean_slug = slugify(data["title"], allow_unicode=False)

            lesson, created = Lesson.objects.get_or_create(
                slug=clean_slug,
                defaults={
                    "title": data["title"],
                    "emoji": data["emoji"],
                    "summary": data["summary"],
                    "level": data["level"],
                    "age_range": data["age_range"],
                    "duration": data["duration"],
                    "materials": data["materials"],
                    "steps": data["steps"],
                    "assistant_image": data["assistant_image"],
                    "theory": data["theory"],
                    "safety_note": data["safety_note"],
                }
            )

            for i, ex_data in enumerate(data["exercises"]):
                Exercise.objects.get_or_create(
                    slug=slugify(ex_data["title"], allow_unicode=False),
                    lesson=lesson,
                    defaults={
                        "title": ex_data["title"],
                        "instructions": ex_data["instructions"],
                        "difficulty": ex_data.get("difficulty", "medium"),
                        "duration": ex_data.get("duration", 5),
                        "order": i + 1,
                    }
                )

        self.stdout.write(self.style.SUCCESS("üéâ –£—Ä–æ–∫–∏ —Ç–∞ –≤–ø—Ä–∞–≤–∏ —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ!"))
