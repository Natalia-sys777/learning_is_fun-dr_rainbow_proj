{% extends "base.html" %}
{% load static %}

{% block title %}
  {% if lesson %}–í–ø—Ä–∞–≤–∏ ‚Äî {{ lesson.title }} ‚Äî Dr Rainbow{% else %}–£—Å—ñ –≤–ø—Ä–∞–≤–∏ ‚Äî Dr Rainbow{% endif %}
{% endblock %}

{% block content %}
<section class="panel" style="padding:1.25rem;display:grid;gap:1rem">
  <header style="display:flex;align-items:center;justify-content:space-between;gap:1rem;flex-wrap:wrap">
    <div>
      <h1 style="margin:0">
        üß© {% if lesson %}–í–ø—Ä–∞–≤–∏ –¥–æ —É—Ä–æ–∫—É: {{ lesson.title }}{% else %}–£—Å—ñ –≤–ø—Ä–∞–≤–∏{% endif %}
      </h1>
      <p class="muted" style="margin:.25rem 0 0">
        {% if lesson %}–û–±–µ—Ä—ñ—Ç—å –≤–ø—Ä–∞–≤—É —Ç–∞ —Ä–æ–∑–ø–æ—á–Ω—ñ–º–æ!{% else %}–¢—Ä–µ–Ω—É–π—Å—è —Ç–∞ –≤—ñ–¥–∫—Ä–∏–≤–∞–π –Ω–æ–≤—ñ –∑–Ω–∞–Ω–Ω—è!{% endif %}
      </p>
    </div>
    <div style="display:flex;gap:.5rem;align-items:center">
      <img src="{% static 'images/assistant_girl.png' %}" alt="" style="height:56px;border-radius:12px;object-fit:cover">
      <img src="{% static 'images/assistant_boy.png' %}" alt="" style="height:56px;border-radius:12px;object-fit:cover">
    </div>
  </header>

  {% if lesson and lesson.slug %}
  <div class="panel" style="padding:.75rem">
    <a class="app-btn" href="{% url 'lesson_detail' lesson.slug %}">‚¨Ö –ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ —É—Ä–æ–∫—É</a>
  </div>
  {% endif %}

  <div style="display:grid;gap:1rem;grid-template-columns:repeat(auto-fit,minmax(240px,1fr))">
    {% for ex in exercises %}
      <article class="panel" style="padding:1rem;display:grid;gap:.5rem">
        <h3 style="margin:0">üéØ {{ ex.title }}</h3>
        {% if ex.lesson %}<span class="muted">–£—Ä–æ–∫: {{ ex.lesson.title }}</span>{% endif %}
        {% if ex.duration or ex.difficulty %}
          <div style="display:flex;gap:.35rem;flex-wrap:wrap">
            {% if ex.difficulty %}
              <span style="font-size:.8rem;padding:.2rem .5rem;border-radius:999px;border:1px solid #e5e7eb;background:#f8fafc">
                ‚≠ê {{ ex.difficulty }}
              </span>
            {% endif %}
            {% if ex.duration %}
              <span style="font-size:.8rem;padding:.2rem .5rem;border-radius:999px;border:1px solid #e5e7eb;background:#fff7ed">
                ‚è±Ô∏è {{ ex.duration }} —Ö–≤
              </span>
            {% endif %}
          </div>
        {% endif %}
        <p class="muted" style="margin:0">
          {{ ex.instructions|default:"–°–ø—Ä–æ–±—É–π –≤–∏–∫–æ–Ω–∞—Ç–∏ –∑–∞–≤–¥–∞–Ω–Ω—è!"|truncatewords:22 }}
        </p>
        <div style="display:flex;gap:.5rem;flex-wrap:wrap;margin-top:.25rem">
          {% if ex.slug %}
            <a class="btn" href="{% url 'exercise_detail' ex.slug %}">–í—ñ–¥–∫—Ä–∏—Ç–∏ ‚ûú</a>
          {% else %}
            <span class="muted" title="–í–ø—Ä–∞–≤–∞ –±–µ–∑ –∞–¥—Ä–µ—Å–∏">‚õî –ë–µ–∑ –¥–æ—Å—Ç—É–ø—É</span>
          {% endif %}
          {% if ex.lesson and ex.lesson.slug %}
            <a class="app-btn" href="{% url 'lesson_detail' ex.lesson.slug %}">üìö –î–æ —É—Ä–æ–∫—É</a>
          {% endif %}
        </div>
      </article>
    {% empty %}
      <article class="panel" style="padding:1rem">
        <p class="muted" style="margin:0">–í–ø—Ä–∞–≤ –ø–æ–∫–∏ –Ω–µ–º–∞—î.</p>
      </article>
    {% endfor %}
  </div>

  {% if is_paginated %}
    <nav class="panel" aria-label="–ü–∞–≥—ñ–Ω–∞—Ü—ñ—è" style="padding:.75rem;display:flex;gap:.5rem;justify-content:center">
      {% if page_obj.has_previous %}
        <a class="app-btn" href="?page={{ page_obj.previous_page_number }}">‚¨Ö –ü–æ–ø–µ—Ä–µ–¥–Ω—è</a>
      {% endif %}
      <span class="muted" style="display:grid;place-items:center">
        –°—Ç–æ—Ä—ñ–Ω–∫–∞ {{ page_obj.number }} –∑ {{ page_obj.paginator.num_pages }}
      </span>
      {% if page_obj.has_next %}
        <a class="app-btn" href="?page={{ page_obj.next_page_number }}">–ù–∞—Å—Ç—É–ø–Ω–∞ ‚ûú</a>
      {% endif %}
    </nav>
  {% endif %}
</section>
{% endblock %}

