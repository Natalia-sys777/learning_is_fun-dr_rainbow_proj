{% extends "base.html" %}
{% load static %}

{% block title %}
  –£—Å—ñ –∑–∞–≤–¥–∞–Ω–Ω—è ‚Äî Dr Rainbow
{% endblock %}

{% block content %}
<section class="panel" style="padding:1.25rem;display:grid;gap:1rem">
  <header style="display:flex;align-items:center;justify-content:space-between;gap:1rem;flex-wrap:wrap">
    <div>
      <h1 style="margin:0">üìù –ó–∞–≤–¥–∞–Ω–Ω—è</h1>
      <p class="muted" style="margin:.25rem 0 0">–û–±–µ—Ä—ñ—Ç—å –∑–∞–≤–¥–∞–Ω–Ω—è ‚Äî —ñ –≤–ø–µ—Ä–µ–¥ –¥–æ –ø—Ä–∏–≥–æ–¥!</p>
    </div>
    <div style="display:flex;gap:.5rem;align-items:center">
      <img src="{% static 'images/assistant_girl.png' %}" alt="" style="height:56px;border-radius:12px;object-fit:cover">
      <img src="{% static 'images/assistant_boy.png' %}" alt="" style="height:56px;border-radius:12px;object-fit:cover">
    </div>
  </header>

  <div style="display:grid;gap:1rem;grid-template-columns:repeat(auto-fit,minmax(240px,1fr))">
    {% for task in tasks %}
      <article class="panel" style="padding:1rem;display:grid;gap:.5rem">
        <h3 style="margin:0">üìå {{ task.title }}</h3>
        {% if task.lesson %}<span class="muted">–î–æ —É—Ä–æ–∫—É: {{ task.lesson.title }}</span>{% endif %}

        {% if task.level or task.duration %}
          <div style="display:flex;gap:.35rem;flex-wrap:wrap">
            {% if task.level %}
              <span style="font-size:.8rem;padding:.2rem .5rem;border-radius:999px;border:1px solid #e5e7eb;background:#f0fdf4">‚≠ê {{ task.level }}</span>
            {% endif %}
            {% if task.duration %}
              <span style="font-size:.8rem;padding:.2rem .5rem;border-radius:999px;border:1px solid #e5e7eb;background:#fff7ed">‚è±Ô∏è {{ task.duration }} —Ö–≤</span>
            {% endif %}
          </div>
        {% endif %}

        {% if task.instructions %}
          <p class="muted" style="margin:0">{{ task.instructions|truncatewords:20 }}</p>
        {% endif %}

        <div style="display:flex;gap:.5rem;flex-wrap:wrap;margin-top:.25rem">
          <a class="btn" href="{% url 'task_detail' task.slug %}">–í—ñ–¥–∫—Ä–∏—Ç–∏ ‚ûú</a>
          {% if task.lesson %}<a class="app-btn" href="{% url 'lesson_detail' task.lesson.slug %}">üìö –î–æ —É—Ä–æ–∫—É</a>{% endif %}
        </div>
      </article>
    {% empty %}
      <article class="panel" style="padding:1rem">
        <p class="muted" style="margin:0">–ü–æ–∫–∏ —â–æ –Ω–µ–º–∞—î –∂–æ–¥–Ω–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è.</p>
      </article>
    {% endfor %}
  </div>

  {% if is_paginated %}
  <nav class="panel" aria-label="–ü–∞–≥—ñ–Ω–∞—Ü—ñ—è" style="padding:.75rem;display:flex;gap:.5rem;justify-content:center">
    {% if page_obj.has_previous %}
      <a class="app-btn" href="?page={{ page_obj.previous_page_number }}">‚¨Ö –ü–æ–ø–µ—Ä–µ–¥–Ω—è</a>
    {% endif %}
    <span class="muted" style="display:grid;place-items:center">–°—Ç–æ—Ä—ñ–Ω–∫–∞ {{ page_obj.number }} –∑ {{ page_obj.paginator.num_pages }}</span>
    {% if page_obj.has_next %}
      <a class="app-btn" href="?page={{ page_obj.next_page_number }}">–ù–∞—Å—Ç—É–ø–Ω–∞ ‚ûú</a>
    {% endif %}
  </nav>
  {% endif %}
</section>
{% endblock %}
