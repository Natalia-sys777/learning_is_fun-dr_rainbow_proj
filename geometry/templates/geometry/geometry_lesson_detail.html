{% extends "base.html" %}
{% block title %}{{ lesson.title }} | –ì–µ–æ–º–µ—Ç—Ä—ñ—è | Dr Rainbow{% endblock %}

{% block content %}
<article class="panel">
  <h2>{{ lesson.emoji }} {{ lesson.title }}</h2>
  <p class="muted">{{ lesson.summary }}</p>

  {% if lesson.image %}
    <div style="text-align: center; margin: 1rem 0;">
      <img src="{{ lesson.image.url }}" alt="–Ü–ª—é—Å—Ç—Ä–∞—Ü—ñ—è –¥–æ {{ lesson.title }}" style="max-width: 100%; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
    </div>
  {% endif %}

  {% if lesson.theory %}
  <section class="panel" aria-label="–¢–µ–æ—Ä—ñ—è">
    <h3>üìö –¢–µ–æ—Ä—ñ—è</h3>
    <p>{{ lesson.theory|linebreaks }}</p>
  </section>
  {% endif %}


  {% if lesson.materials %}
  <section style="margin-top: 1rem;">
    <h3>üß∞ –ú–∞—Ç–µ—Ä—ñ–∞–ª–∏</h3>
    <ul>
  {% for step in steps_list %}
    <li>{{ step }}</li>
  {% endfor %}
    </ul>
  </section>
  {% endif %}

  {% if lesson.steps %}
  <section style="margin-top: 1rem;">
    <h3>üß™ –ö—Ä–æ–∫–∏</h3>
    <ol>
  {% for step in steps_list %}
    <li>{{ step }}</li>
  {% endfor %}
    </ol>
  </section>
  {% endif %}

  {% if lesson.safety_note %}
  <section style="margin-top: 1rem;">
    <h3>‚ö†Ô∏è –ó–∞—É–≤–∞–∂–µ–Ω–Ω—è</h3>
    <p class="muted">{{ lesson.safety_note }}</p>
  </section>
  {% endif %}

  {% if exercises %}
  <section style="margin-top: 2rem;">
    <h3>üß© –í–ø—Ä–∞–≤–∏</h3>
    <div class="grid" style="display: grid; gap: 1rem; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));">
      {% for exercise in exercises %}
        <div class="panel">
          <h4>{{ exercise.title }}</h4>
          <p>{{ exercise.instructions }}</p>
        </div>
      {% endfor %}
    </div>
  </section>
  {% endif %}

</article>

<section class="panel" style="margin-top: 2rem;">
  <h3>üéÅ –Ü–Ω—à—ñ —É—Ä–æ–∫–∏</h3>
  <div class="grid" style="display: grid; gap: 1rem; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));">
    {% for related in related_lessons %}
      <a href="{% url 'geometry:lesson_detail' related.slug %}" class="panel" style="text-align: center;">
        {% if related.image %}
          <img src="{{ related.image.url }}" alt="–ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è {{ related.title }}" style="width: 100%; border-radius: 12px; max-height: 120px; object-fit: cover;">
        {% endif %}
        <h4>{{ related.title }}</h4>
        <p class="tiny muted">{{ related.summary|truncatechars:70 }}</p>
      </a>
    {% endfor %}
  </div>
</section>

{% endblock %}
