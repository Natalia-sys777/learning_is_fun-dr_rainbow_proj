{% extends "base.html" %}
{% block title %}–ì–µ–æ–º–µ—Ç—Ä—ñ—è ‚Äî –£—Ä–æ–∫–∏ | Dr Rainbow{% endblock %}

{% block content %}
<section class="panel">
  <h2>üìê –ì–µ–æ–º–µ—Ç—Ä—ñ—è –¥–ª—è –ø–æ—á–∞—Ç–∫—ñ–≤—Ü—ñ–≤</h2>
  <p class="muted">–î–æ—Å–ª—ñ–¥–∂—É—î–º–æ —Ñ—ñ–≥—É—Ä–∏, —Ñ–æ—Ä–º–∏ —Ç–∞ –ø—Ä–æ—Å—Ç—ñ—Ä —É –≤–µ—Å–µ–ª–∏–π —Å–ø–æ—Å—ñ–±!</p>
</section>

<form method="get" class="panel" style="display: flex; flex-wrap: wrap; gap: 1rem;">
  <input type="text" name="q" value="{{ q }}" placeholder="üîç –ü–æ—à—É–∫..." class="app-btn" style="flex: 1;">
  <select name="level" class="app-btn">
    <option value="">üî¢ –í—Å—ñ —Ä—ñ–≤–Ω—ñ</option>
    <option value="–¥—É–∂–µ –ª–µ–≥–∫–æ" {% if level == "–¥—É–∂–µ –ª–µ–≥–∫–æ" %}selected{% endif %}>ü•â –î—É–∂–µ –ª–µ–≥–∫–æ</option>
    <option value="–ª–µ–≥–∫–æ" {% if level == "–ª–µ–≥–∫–æ" %}selected{% endif %}>ü•à –õ–µ–≥–∫–æ</option>
    <option value="—Å–µ—Ä–µ–¥–Ω—å–æ" {% if level == "—Å–µ—Ä–µ–¥–Ω—å–æ" %}selected{% endif %}>ü•á –°–µ—Ä–µ–¥–Ω—å–æ</option>
  </select>
  <button type="submit" class="btn">–ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏</button>
</form>

<section class="grid" style="display: grid; gap: 1rem; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));">
  {% for lesson in lessons %}
    <a href="{% url 'geometry:lesson_detail' lesson.slug %}" class="panel" style="text-align: center;">
      {% if lesson.image %}
        <img src="{{ lesson.image.url }}" alt="–ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è —É—Ä–æ–∫—É {{ lesson.title }}" style="width: 100%; border-radius: 12px; object-fit: cover; max-height: 160px;">
      {% endif %}
      <h3 style="margin-top: 0.5rem;">{{ lesson.title }}</h3>
      <p class="muted">{{ lesson.summary|truncatechars:80 }}</p>
      <p class="tiny">üìè –†—ñ–≤–µ–Ω—å: {{ lesson.level }}</p>
    </a>
  {% empty %}
    <p class="muted">–ù–∞—Ä–∞–∑—ñ –Ω–µ–º–∞—î –¥–æ—Å—Ç—É–ø–Ω–∏—Ö —É—Ä–æ–∫—ñ–≤.</p>
  {% endfor %}
</section>

{% if is_paginated %}
  <div class="panel" style="text-align: center;">
    {% if page_obj.has_previous %}
      <a href="?page={{ page_obj.previous_page_number }}&q={{ q }}&level={{ level }}" class="app-btn">‚Üê –ù–∞–∑–∞–¥</a>
    {% endif %}
    <span class="muted">–°—Ç–æ—Ä—ñ–Ω–∫–∞ {{ page_obj.number }} –∑ {{ page_obj.paginator.num_pages }}</span>
    {% if page_obj.has_next %}
      <a href="?page={{ page_obj.next_page_number }}&q={{ q }}&level={{ level }}" class="app-btn">–í–ø–µ—Ä–µ–¥ ‚Üí</a>
    {% endif %}
  </div>
{% endif %}
{% endblock %}
